<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BRACU CGPA Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>BRACU CGPA Calculator</h1>
            <p>Calculate your semester CGPA with precision</p>
        </div>
        <div class="content">
            <div class="section">
                <h2 class="section-title">Previous Academic Record</h2>
                <div class="form-row">
                    <div class="form-col">
                        <label for="prevCgpa">CGPA (Till Previous Semester)</label>
                        <input type="number" id="prevCgpa" step="0.01" min="0" max="4" placeholder="e.g., 3.50">
                    </div>
                    <div class="form-col">
                        <label for="prevCredits">Total Credits Completed</label>
                        <input type="number" id="prevCredits" min="0" placeholder="e.g., 45">
                    </div>
                </div>
            </div>
            <div class="section">
                <h2 class="section-title">Current Semester</h2>
                <div class="form-group">
                    <label for="numCourses">Total Courses This Semester</label>
                    <input type="number" id="numCourses" min="1" max="10" placeholder="e.g., 4">
                </div>
                <div class="courses-container" id="coursesContainer" style="display: none;">
                    <h4>Course Grades & Credits</h4>
                    <div id="coursesList"></div>
                </div>
            </div>
            <button class="calculate-btn" onclick="calculateCGPA()">Calculate CGPA</button>
            <div class="result" id="result">
                <h3>Your New CGPA</h3>
                <div class="cgpa-value" id="cgpaValue">0.00</div>
                <p>Keep up the excellent work!</p>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('numCourses').addEventListener('input', function() {
            const numCourses = parseInt(this.value) || 0;
            const container = document.getElementById('coursesContainer');
            const coursesList = document.getElementById('coursesList');
            
            if (numCourses > 0) {
                container.style.display = 'block';
                coursesList.innerHTML = '';
                
                for (let i = 1; i <= numCourses; i++) {
                    const courseDiv = document.createElement('div');
                    courseDiv.className = 'course-item';
                    courseDiv.innerHTML = `
                        <div class="course-number">${i}</div>
                        <div class="course-inputs">
                            <div class="grade-input">
                                <label>CGPA (0-4.0)</label>
                                <input type="number" id="grade${i}" min="0" max="4" step="0.01" placeholder="3.7">
                            </div>
                            <div>
                                <label>Credits</label>
                                <div class="credit-toggle" id="creditToggle${i}">
                                    <div class="credit-option active" onclick="setCredit(${i}, 3)">3</div>
                                    <div class="credit-option" onclick="setCredit(${i}, 4)">4</div>
                                </div>
                                <input type="hidden" id="credit${i}" value="3">
                            </div>
                        </div>
                    `;
                    coursesList.appendChild(courseDiv);
                }
            } else {
                container.style.display = 'none';
            }
        });

        function setCredit(courseNum, credit) {
            const toggle = document.getElementById(`creditToggle${courseNum}`);
            const options = toggle.querySelectorAll('.credit-option');
            const hiddenInput = document.getElementById(`credit${courseNum}`);
            
            options.forEach(option => option.classList.remove('active'));
            if (credit === 3) {
                options[0].classList.add('active');
            } else {
                options[1].classList.add('active');
            }
            
            hiddenInput.value = credit;
        }

        function calculateCGPA() {
            const prevCgpa = parseFloat(document.getElementById('prevCgpa').value) || 0;
            const prevCredits = parseFloat(document.getElementById('prevCredits').value) || 0;
            const numCourses = parseInt(document.getElementById('numCourses').value) || 0;
            
            if (numCourses === 0) {
                alert('Please enter the number of courses for this semester.');
                return;
            }
            
            let totalNewGradePoints = 0;
            let totalNewCredits = 0;
            let hasEmptyGrades = false;
            
            for (let i = 1; i <= numCourses; i++) {
                const gradeInput = document.getElementById(`grade${i}`);
                const creditInput = document.getElementById(`credit${i}`);
                
                const cgpa = parseFloat(gradeInput.value);
                const credit = parseFloat(creditInput.value);
                
                if (isNaN(cgpa) || cgpa < 0 || cgpa > 4) {
                    hasEmptyGrades = true;
                    gradeInput.style.borderColor = '#e74c3c';
                } else {
                    gradeInput.style.borderColor = '#e2e8f0';
                    totalNewGradePoints += cgpa * credit;
                    totalNewCredits += credit;
                }
            }
            
            if (hasEmptyGrades) {
                alert('Please fill in all course CGPAs with valid values (0-4.0).');
                return;
            }
            
            const totalPrevGradePoints = prevCgpa * prevCredits;
            const newCGPA = (totalPrevGradePoints + totalNewGradePoints) / (prevCredits + totalNewCredits);
            
            const resultDiv = document.getElementById('result');
            const cgpaValue = document.getElementById('cgpaValue');
            
            cgpaValue.textContent = newCGPA.toFixed(2);
            resultDiv.classList.add('show');
            
            resultDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
    </script>
</body>
</html>
